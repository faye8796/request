# 세종학당 문화교구 신청 플랫폼

세종학당 문화인턴을 위한 교구 신청 및 수업계획 관리 시스템입니다.

## 🌐 접속 방법
- **배포 사이트**: https://culturing.org/request
- **GitHub Pages**: https://faye8796.github.io/request

## 🔑 테스트 계정
- **학생**: 김민수 (1998-03-15)
- **관리자**: admin123

## ✨ 주요 기능

### 📚 수업계획 기반 예산 배정 시스템 (NEW!)
- **분야별 회당 지원금 설정**: 관리자가 각 분야별로 수업 1회당 지원금액과 최대 상한 설정
- **자동 예산 계산**: 수업 횟수 × 분야별 회당 지원금 = 배정 예산 (최대 상한 적용)
- **수업계획 승인 기반 예산 배정**: 관리자가 수업계획을 승인해야 예산 배정 및 교구 신청 가능
- **분야별 예산 차등화**:
  - 한국요리문화: 35,000원/회 (소모품 많음)
  - 전통음악: 30,000원/회 (악기 등 고가 교구)
  - K-Pop 문화: 10,000원/회 (소모품 적음)
  - 기타 분야: 15,000원 ~ 25,000원/회

### 📚 수업계획 관리
- **학생 기능**:
  - 파견 기간 및 총 수업 횟수 설정
  - 수업별 주제와 내용 작성
  - 자동 수업 일정 생성 (주 3회 기준)
  - 임시저장 및 완료 제출
  - 관리자 설정 마감일까지 수정 가능
  
- **관리자 기능**:
  - 수업계획 수정 마감일 설정
  - **수업계획 승인/반려 시스템** ⭐
    - 완료된 수업계획 검토 및 승인/반려
    - 반려 시 상세한 반려 사유 제공
    - 승인 시 자동 예산 배정
  - **분야별 예산 설정 관리** ⭐
    - 각 분야별 회당 지원금 설정
    - 최대 예산 상한 설정
    - 예산 설정 변경 시 기존 승인된 학생 예산 재계산
  - **테스트 모드**: 기능 테스트를 위한 항상 편집 허용 ⭐
  - **마감일 무시 모드**: 운영 중 긴급 수정을 위한 모드
  - 학생별 수업계획 완료 현황 모니터링
  - 수업계획 상태 확인 (완료/임시저장/미작성)

### 🛒 교구 신청 시스템 (업데이트!)
- **수업계획 승인 필수**: 수업계획이 승인된 후에만 교구 신청 가능 🆕
- **온라인 구매**: 관리자가 대신 구매하여 배송
- **🆕 오프라인 구매**: 학생이 직접 구매 후 영수증 제출로 비용 정산
  - 승인 후 영수증 등록 버튼 활성화
  - 이미지 업로드 (드래그 앤 드롭 지원)
  - 구매일시, 구매처, 비고 정보 입력
  - 영수증 제출 시 자동 구매완료 처리
  - 관리자 영수증 확인 및 다운로드 기능

### 👨‍🎓 학생 기능
- **예산 현황 확인**: 분야별 배정된 예산과 사용 현황 실시간 모니터링 🆕
- **수업계획 기반 제한**: 수업계획 승인 전에는 교구 신청 불가 🆕
- **구매 방식 선택**: 온라인/오프라인 구매 선택 가능 🆕
- 교구 신청 (이름, 목적, 가격, 구매링크)
- 묶음 교구 신청 (온라인 쇼핑몰 계정 정보 포함)
- **영수증 등록**: 오프라인 구매 승인 시 영수증 제출 🆕
- 실시간 예산 사용 현황 모니터링
- 신청 상태 추적 (검토중/승인/반려/구매완료)
- 배송지 정보 관리
- 수업계획 작성 및 관리

### 👩‍💼 관리자 기능  
- **분야별 예산 설정**: 각 분야의 회당 지원금과 최대 상한 설정 🆕
- **수업계획 승인 관리**: 제출된 수업계획 승인/반려 처리 🆕
- **예산 배정 관리**: 수업계획 승인 시 자동 예산 배정 🆕
- 모든 학생 신청 내역 조회
- 학생별 예산 사용률 모니터링
- 승인/반려/구매완료 처리
- **영수증 관리**: 오프라인 구매 영수증 확인 및 다운로드 🆕
- **구매 방식별 통계**: 온라인/오프라인 구매 현황 추적 🆕
- 반려 사유 입력
- 검색 및 필터링
- Excel 데이터 내보내기 (예산 정보 및 구매 방식 정보 포함)
- 수업계획 설정 관리

### 📊 새로운 예산 관리 시스템 (MAJOR UPDATE!)
- **분야별 차등 예산**: 교구 소모 정도에 따른 분야별 차등 지원
- **수업 횟수 기반 자동 계산**: (총 수업 횟수 × 분야별 회당 지원금)
- **최대 상한 적용**: 과도한 예산 배정 방지를 위한 분야별 최대 상한
- **승인 기반 배정**: 수업계획 승인 후에만 예산 배정 및 교구 신청 가능
- **실시간 예산 추적**: 배정/사용/잔여 예산 실시간 모니터링
- **시각적 진행률 표시**: 예산 사용률에 따른 색상 구분 (안전/경고/위험)

## 💰 분야별 예산 체계 (NEW!)

### 예산 배정 원리
```
배정 예산 = MIN(총 수업 횟수 × 분야별 회당 지원금, 분야별 최대 상한)
```

### 분야별 회당 지원금 설정
| 분야 | 회당 지원금 | 최대 상한 | 특징 |
|------|------------|-----------|------|
| 한국요리문화 | 35,000원 | 800,000원 | 식재료, 조리도구 등 소모품 다량 소요 |
| 전통음악 | 30,000원 | 750,000원 | 전통악기 등 고가 교구 필요 |
| 전통문화예술 | 25,000원 | 600,000원 | 다양한 전통 문화 체험 도구 |
| 한국미술 | 22,000원 | 550,000원 | 미술 재료 및 도구 |
| 한국현대문화 | 18,000원 | 450,000원 | 현대 문화 체험 자료 |
| 한국어교육 | 15,000원 | 400,000원 | 교육 자료 및 교구 |
| K-Pop 문화 | 10,000원 | 300,000원 | 소모품이 적은 문화 체험 |

### 예산 배정 예시
- **K-Pop 분야, 30회 수업**: 30회 × 10,000원 = 300,000원 (상한 내)
- **한국요리문화, 30회 수업**: 30회 × 35,000원 = 1,050,000원 → 800,000원 (상한 적용)
- **한국어교육, 24회 수업**: 24회 × 15,000원 = 360,000원 (상한 내)

## 🛍️ 구매 방식 안내 (NEW!)

### 온라인 구매 📦
- **장점**: 배송 편의성, 관리자가 직접 처리
- **절차**: 신청 → 관리자 승인 → 관리자 구매 → 배송
- **적합한 경우**: 일반적인 교구, 온라인에서 구매 가능한 상품

### 오프라인 구매 🏪  
- **장점**: 현지에서만 구할 수 있는 특별한 교구 구매 가능
- **절차**: 신청 → 관리자 승인 → 학생 직접 구매 → 영수증 제출 → 비용 정산
- **적합한 경우**: 
  - 현지 전통 문화 용품
  - 현지에서만 구할 수 있는 재료
  - 신선 식품 등 배송이 어려운 상품
  - 현지 서점의 특별한 도서

### 영수증 제출 과정 📄
1. **관리자 승인** 후 '영수증 등록' 버튼 활성화
2. **영수증 촬영** 또는 이미지 파일 준비
3. **영수증 등록**:
   - 이미지 업로드 (드래그 앤 드롭 지원)
   - 구매일시 입력
   - 구매처 정보 입력
   - 추가 설명 (선택사항)
4. **제출 완료** 시 자동으로 구매완료 처리
5. **관리자 확인** 및 비용 정산 진행

## 🏫 지원 학당 및 분야

### 아시아 지역
- 하노이 세종학당 - 한국어교육
- 방콕 세종학당 - 전통문화예술  
- 자카르타 세종학당 - K-Pop 문화
- 쿠알라룸푸르 세종학당 - 한국어교육
- 마닐라 세종학당 - 한국현대문화

### 유럽/미주 지역
- 뉴욕 세종학당 - 전통음악
- 런던 세종학당 - 한국미술
- 파리 세종학당 - 한국요리문화

## 📁 파일 구조
```
/request/
├── index.html              # 메인 페이지 (예산 설정 모달 포함)
├── css/                    # 스타일 파일들
│   ├── main.css           # 공통 스타일
│   ├── login.css          # 로그인 페이지
│   ├── student.css        # 학생 대시보드 (예산 현황 스타일 포함)
│   └── admin.css          # 관리자 대시보드 (예산/수업계획 관리 스타일 포함)
└── js/                     # JavaScript 파일들
    ├── data.js            # 데이터 관리 (예산 시스템 로직 포함)
    ├── utils.js           # 공통 유틸리티
    ├── auth.js            # 인증 관리
    ├── lesson-plan.js     # 수업계획 관리
    ├── student.js         # 학생 기능 (예산 제한 로직 포함)
    ├── admin.js           # 관리자 기능 (예산/수업계획 승인 기능 포함)
    └── app.js             # 메인 앱 로직
```

## 🛠 기술 스택
- **Frontend**: Vanilla JavaScript, HTML5, CSS3
- **Icons**: Lucide Icons
- **Future**: Supabase 연동 예정

## 📋 개발 상태
- ✅ 기본 UI/UX 완성
- ✅ 로그인 시스템
- ✅ 학생 신청 기능
- ✅ 관리자 관리 기능
- ✅ 기존 예산 관리 시스템
- ✅ **새로운 예산 배정 시스템 (NEW!)**
- ✅ **수업계획 승인/반려 시스템 (NEW!)**
- ✅ **분야별 예산 설정 관리 (NEW!)**
- ✅ 반응형 디자인
- ✅ 키보드 단축키 지원
- ✅ 수업계획 작성 시스템
- ✅ 수업계획 관리자 설정
- ✅ 학생 로그인 시 수업계획 체크
- ✅ 테스트 모드 및 개발자 도구
- ✅ **오프라인 구매 시스템**
- ✅ **영수증 등록 및 관리**
- 🔄 Supabase 연동 예정
- 🔄 이메일 알림 시스템 예정

## ⌨️ 키보드 단축키
- `Alt + 1`: 로그인 페이지
- `Alt + 2`: 수업계획 페이지 (학생)
- `Alt + 3`: 학생 대시보드 (학생)
- `Alt + 4`: 관리자 대시보드 (관리자)
- `Ctrl/Cmd + N`: 새 교구 신청 (학생)
- `Ctrl/Cmd + F`: 검색 (관리자)
- `Ctrl/Cmd + E`: Excel 내보내기 (관리자)
- `Ctrl/Cmd + T`: 테스트 모드 토글 (관리자)
- `Ctrl/Cmd + B`: 예산 설정 모달 (관리자) 🆕
- `Ctrl/Cmd + L`: 수업계획 관리 모달 (관리자) 🆕
- `Ctrl/Cmd + Enter`: 폼 제출
- `ESC`: 모달 닫기
- `F5`: 데이터 새로고침

## 📝 수업계획 기반 예산 배정 시스템

### 전체 프로세스
1. **학생**: 수업계획 작성 및 제출
2. **관리자**: 수업계획 검토 및 승인/반려
3. **시스템**: 승인 시 자동 예산 배정 (분야 × 수업 횟수)
4. **학생**: 배정된 예산 내에서 교구 신청 가능
5. **관리자**: 예산 사용 현황 모니터링

### 관리자 예산 설정 방법
1. **예산 설정 버튼** 클릭 (또는 `Ctrl + B`)
2. **분야별 설정**:
   - 회당 지원금: 해당 분야 수업 1회당 지원할 금액
   - 최대 상한: 개인당 최대 배정 가능한 예산
3. **설정 저장** 시 기존 승인된 학생들의 예산 자동 재계산

### 수업계획 승인 관리
1. **수업계획 관리 버튼** 클릭 (또는 `Ctrl + L`)
2. **제출된 수업계획 검토**:
   - 수업 횟수, 내용, 목표 확인
   - 예상 배정 예산 미리보기
3. **승인/반려 처리**:
   - 승인: 자동 예산 배정 및 교구 신청 허용
   - 반려: 상세한 반려 사유 입력

### 학생 사용법
1. **수업계획 작성**: 총 수업 횟수와 상세 계획 작성
2. **수업계획 제출**: 완료 후 관리자 승인 대기
3. **예산 배정 확인**: 승인 시 자동 배정된 예산 확인
4. **교구 신청**: 배정된 예산 내에서 교구 신청
5. **예산 모니터링**: 실시간 예산 사용 현황 확인

## 🧪 테스트 가이드

### 새로운 예산 시스템 테스트
1. **관리자로 로그인** (admin123)
2. **예산 설정 테스트**:
   - "예산 설정" 버튼 클릭
   - 각 분야별 회당 지원금 수정
   - 최대 상한 조정
   - 설정 저장 후 재계산 확인
3. **수업계획 승인 테스트**:
   - "수업계획 관리" 버튼 클릭
   - 제출된 수업계획 승인
   - 예산 자동 배정 확인
4. **학생으로 로그인** (김민수, 1998-03-15)
5. **예산 현황 확인**:
   - 배정된 예산 정보 확인
   - 분야별 정보 표시 확인
6. **교구 신청 제한 테스트**:
   - 수업계획 미승인 시 신청 불가 확인
   - 예산 초과 신청 시 경고 메시지 확인

### 기능 테스트 방법
1. **관리자로 로그인** (admin123)
2. **테스트 모드 활성화**:
   - 방법 1: `Ctrl + T` 단축키 사용
   - 방법 2: "수업계획 설정" → "테스트 모드" 체크
3. **학생으로 로그인** (김민수, 1998-03-15)
4. **수업계획 작성 및 수정 테스트**
5. **오프라인 구매 기능 테스트**:
   - 교구 신청 시 "오프라인 구매" 선택
   - 관리자에서 승인 처리
   - 학생에서 영수증 등록 테스트
   - 관리자에서 영수증 확인
6. **필요 시 관리자에서 다시 테스트 모드 해제**

## 🔄 업데이트 내역

### v1.3.0 (2025-06-12) - 수업계획 기반 예산 배정 시스템 구축
- ✅ **분야별 예산 설정 시스템**: 관리자가 각 분야별 회당 지원금과 최대 상한 설정
- ✅ **수업계획 승인/반려 시스템**: 관리자가 수업계획을 검토하고 승인/반려 처리
- ✅ **자동 예산 배정**: 수업계획 승인 시 (수업 횟수 × 분야별 지원금) 기반 자동 예산 계산
- ✅ **수업계획 기반 제한**: 수업계획 승인 전에는 교구 신청 불가
- ✅ **예산 현황 개선**: 배정/사용/잔여 예산 상세 표시, 분야 정보 포함
- ✅ **관리자 예산 관리**: 예산 설정 모달, 수업계획 관리 모달 추가
- ✅ **실시간 예산 재계산**: 예산 설정 변경 시 기존 승인된 학생 예산 자동 재계산
- ✅ **Excel 내보내기 개선**: 예산 정보(배정/사용/잔여) 포함

### v1.2.0 (2025-06-12) - 오프라인 구매 시스템 추가
- ✅ **오프라인 구매 방식 추가**: 학생 직접 구매 후 영수증 제출
- ✅ **구매 방식 선택**: 신청 시 온라인/오프라인 구매 방식 선택
- ✅ **영수증 등록 시스템**: 이미지 업로드, 구매 정보 입력, 드래그 앤 드롭 지원
- ✅ **관리자 영수증 관리**: 영수증 확인, 다운로드, 구매완료 자동 처리
- ✅ **구매 방식별 통계**: 온라인/오프라인 구매 현황 모니터링
- ✅ **Excel 내보내기 개선**: 구매 방식, 영수증 정보 포함
- ✅ **UI/UX 개선**: 영수증 관련 상태 표시, 반응형 지원

### v1.1.1 (2025-06-12) - 기능 테스트 지원 업데이트
- ✅ 테스트 모드 추가: 기능 테스트를 위한 항상 편집 허용 모드
- ✅ 마감일 무시 모드 추가: 운영 중 긴급 수정을 위한 모드
- ✅ 관리자 빠른 토글: `Ctrl + T` 단축키로 테스트 모드 토글
- ✅ 편집 상태 알림 개선: 현재 편집 모드 시각적 표시
- ✅ 개발자 도구 강화: 콘솔 로그 및 디버깅 지원

### v1.1.0 (2025-06-12)
- ✅ 수업계획 작성 시스템 추가
- ✅ 관리자 수업계획 설정 기능 추가
- ✅ 학생 로그인 시 수업계획 체크 로직 추가
- ✅ 수업계획 관련 UI/UX 개선
- ✅ 반응형 수업계획 테이블 구현
- ✅ 수업계획 유효성 검증 강화

### v1.0.0 (2024-06-10)
- ✅ 기본 교구 신청 시스템 구현
- ✅ 관리자 대시보드 구현
- ✅ 기존 예산 관리 시스템 구현

## 💡 사용 시나리오 예시

### 새로운 예산 배정 시나리오
> **상황**: 한국요리문화 분야 인턴이 30회 수업을 계획하는 경우
> 1. 수업계획 작성: 30회 수업, 각 회차별 요리 실습 계획 작성
> 2. 관리자 승인: 수업계획 검토 후 승인
> 3. 자동 예산 배정: 30회 × 35,000원 = 1,050,000원 → 800,000원 (최대 상한 적용)
> 4. 교구 신청: 800,000원 예산 내에서 식재료, 조리도구 등 신청
> 5. 실시간 모니터링: 예산 사용률에 따른 시각적 피드백

### 온라인 구매 시나리오
> **상황**: 한국 전통 차 세트를 구매하고 싶은 경우
> 1. 교구 신청 시 "온라인 구매" 선택
> 2. 쿠팡 등 온라인 쇼핑몰 링크 첨부
> 3. 관리자 승인 후 관리자가 직접 구매하여 파견지로 배송

### 오프라인 구매 시나리오
> **상황**: 베트남 현지 전통 의상(아오자이)을 구매하고 싶은 경우
> 1. 교구 신청 시 "오프라인 구매" 선택
> 2. 참고용 링크나 구매 예정 장소 정보 입력
> 3. 관리자 승인 후 현지에서 직접 구매
> 4. 영수증 촬영하여 시스템에 등록
> 5. 관리자 확인 후 계좌로 비용 정산

## 📞 문의
프로젝트 관련 문의사항이 있으시면 GitHub Issues를 통해 연락주세요.

## 🎯 향후 개발 계획
1. **Supabase 연동**: 실시간 데이터베이스 연동
2. **이메일 알림**: 신청 상태 변경 시 자동 알림
3. **모바일 앱**: React Native 기반 모바일 앱 개발
4. **고급 통계**: 더 상세한 분석 및 리포팅 기능
5. **다국어 지원**: 영어, 현지어 지원 추가
6. **수업계획 템플릿**: 미리 정의된 수업계획 템플릿 제공
7. **영수증 OCR**: 영수증 자동 인식 및 정보 추출
8. **비용 정산 시스템**: 자동화된 비용 정산 프로세스
9. **예산 분석 대시보드**: 분야별 예산 사용 패턴 분석
10. **수업계획 품질 평가**: AI 기반 수업계획 내용 분석 및 개선 제안