<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¸ì¢…í•™ë‹¹ ë¬¸í™”ì¸í„´ ì§€ì› ì‹œìŠ¤í…œ v4.2.0</title>
    
    <!-- CSS Files - v4.2.0 í˜¸í™˜ -->
    <link rel="stylesheet" href="css/main.css?v=4.2.0">
    <link rel="stylesheet" href="css/login.css?v=4.2.0">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Supabase JavaScript Client - v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Main App Container -->
    <div id="app">
        <!-- í•™ìƒ ë¡œê·¸ì¸ í˜ì´ì§€ -->
        <div id="loginPage" class="page active">
            <div class="login-container">
                <div class="login-card">
                    <div class="login-header">
                        <h1>ì„¸ì¢…í•™ë‹¹ ë¬¸í™”ì¸í„´ ì§€ì› ì‹œìŠ¤í…œ v4.2.0</h1>
                        <p>King Sejong Institute Cultural Intern Support System (Modular Architecture)</p>
                    </div>

                    <!-- ğŸ†• v4.2.0 ëª¨ë“ˆ ë¡œë”© ìƒíƒœ í‘œì‹œ -->
                    <div id="moduleStatus" style="background: #f7fafc; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem; font-family: monospace; font-size: 0.875rem;">
                        <h4 style="margin: 0 0 0.5rem 0; color: #2d3748;">ğŸ“¦ ëª¨ë“ˆ ì‹œìŠ¤í…œ v4.2.0</h4>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.25rem 0;">
                            <span>ì‹œìŠ¤í…œ ìƒíƒœ</span>
                            <span id="system-status" style="font-weight: bold; color: #f6ad55;">â³ ì´ˆê¸°í™” ì¤‘...</span>
                        </div>
                    </div>

                    <!-- í•™ìƒ ë¡œê·¸ì¸ í¼ -->
                    <div id="studentLogin" class="login-form active">
                        <div class="form-group">
                            <label>ì´ë¦„</label>
                            <input type="text" id="studentName" placeholder="ì„±ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label>ìƒë…„ì›”ì¼</label>
                            <input type="date" id="studentBirth">
                        </div>
                        <button id="studentLoginBtn" class="login-btn primary">
                            <i data-lucide="user"></i>
                            í•™ìƒ ë¡œê·¸ì¸
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸš€ JavaScript Files - v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ -->
    
    <!-- ğŸ”§ 1ë‹¨ê³„: í•µì‹¬ ì„¤ì • (í•„ìˆ˜) -->
    <script src="js/config.js?v=4.2.0"></script>
    <script src="js/utils.js?v=4.2.0"></script>
    <script src="js/auth.js?v=4.2.0"></script>

    <!-- ğŸ”§ 2ë‹¨ê³„: Supabase ëª¨ë“ˆë“¤ (ìˆœì„œ ì¤‘ìš”!) -->
    <script src="js/supabase/supabase-core.js?v=4.2.0"></script>
    <script src="js/supabase/supabase-student.js?v=4.2.0"></script>
    <script src="js/supabase/supabase-admin.js?v=4.2.0"></script>
    <script src="js/supabase-client.js?v=4.2.0"></script>
    
    <!-- ğŸ”§ 3ë‹¨ê³„: í˜ì´ì§€ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ - v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ -->
    <script>
        // ğŸ”§ v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“‹ Index.html v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œì‘...');
            
            try {
                // Lucide ì•„ì´ì½˜ ì´ˆê¸°í™”
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                    console.log('âœ… Lucide icons initialized (v4.2.0)');
                } else {
                    console.error('âŒ Lucide library not loaded');
                }

                // ğŸ†• v4.2.0 ëª¨ë“ˆ ë¡œë”© ëŒ€ê¸° ë° ì´ˆê¸°í™”
                initializeModuleSystem();
                
            } catch (error) {
                console.error('âŒ í˜ì´ì§€ ì´ˆê¸°í™” ì˜¤ë¥˜ (v4.2.0):', error);
                updateSystemStatus('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨', '#f56565');
            }
        });

        // ğŸ”§ v4.2.0 ëª¨ë“ˆ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        async function initializeModuleSystem() {
            console.log('ğŸ”„ v4.2.0 ëª¨ë“ˆ ì‹œìŠ¤í…œ ì´ˆê¸°í™”...');
            updateSystemStatus('â³ ëª¨ë“ˆ ë¡œë”© ì¤‘...', '#f6ad55');
            
            try {
                // 1ë‹¨ê³„: ëª¨ë“ˆ ë¡œë”© ëŒ€ê¸° (ìµœëŒ€ 10ì´ˆ)
                const modulesLoaded = await waitForModules();
                
                if (!modulesLoaded) {
                    console.warn('âš ï¸ ì¼ë¶€ ëª¨ë“ˆ ë¡œë”© ì‹¤íŒ¨ - ê¸°ë³¸ ê¸°ëŠ¥ë§Œ ì‚¬ìš©');
                    updateSystemStatus('âš ï¸ ë¶€ë¶„ ë¡œë”©', '#ed8936');
                } else {
                    console.log('âœ… ëª¨ë“  ëª¨ë“ˆ ë¡œë”© ì™„ë£Œ');
                    updateSystemStatus('âœ… ì¤€ë¹„ ì™„ë£Œ', '#48bb78');
                }

                // 2ë‹¨ê³„: AuthManager ì´ˆê¸°í™”
                if (window.AuthManager && typeof window.AuthManager.init === 'function') {
                    window.AuthManager.init();
                    console.log('âœ… AuthManager ì´ˆê¸°í™” ì™„ë£Œ (v4.2.0)');
                } else {
                    console.warn('âš ï¸ AuthManagerë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ - ê¸°ë³¸ ì¸ì¦ ì‚¬ìš©');
                }

                // 3ë‹¨ê³„: SupabaseAPI ì´ˆê¸°í™” í™•ì¸
                if (window.SupabaseAPI && typeof window.SupabaseAPI.init === 'function') {
                    const apiSuccess = await window.SupabaseAPI.init();
                    console.log('ğŸ”— SupabaseAPI ì´ˆê¸°í™”:', apiSuccess ? 'ì„±ê³µ' : 'ì‹¤íŒ¨');
                }
                
                console.log('ğŸ‰ Index.html v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ!');
                
            } catch (error) {
                console.error('âŒ ëª¨ë“ˆ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                updateSystemStatus('âŒ ì‹œìŠ¤í…œ ì˜¤ë¥˜', '#f56565');
            }
        }

        // ğŸ”§ ëª¨ë“ˆ ë¡œë”© ëŒ€ê¸° í•¨ìˆ˜
        function waitForModules() {
            return new Promise((resolve) => {
                let attempts = 0;
                const maxAttempts = 100; // 10ì´ˆ
                
                const checkModules = () => {
                    attempts++;
                    
                    const coreLoaded = !!window.SupabaseCore;
                    const studentLoaded = !!window.SupabaseStudent;
                    const adminLoaded = !!window.SupabaseAdmin;
                    const apiLoaded = !!window.SupabaseAPI;
                    
                    console.log(`ğŸ“¦ ëª¨ë“ˆ ë¡œë”© ì²´í¬ ${attempts}/${maxAttempts}:`, {
                        Core: coreLoaded ? 'âœ…' : 'âŒ',
                        Student: studentLoaded ? 'âœ…' : 'âŒ',
                        Admin: adminLoaded ? 'âœ…' : 'âŒ',
                        API: apiLoaded ? 'âœ…' : 'âŒ'
                    });
                    
                    // ìµœì†Œ ìš”êµ¬ì‚¬í•­: Core + API
                    if (coreLoaded && apiLoaded) {
                        console.log('âœ… ìµœì†Œ ëª¨ë“ˆ ë¡œë”© ì™„ë£Œ');
                        resolve(true);
                        return;
                    }
                    
                    if (attempts >= maxAttempts) {
                        console.warn('âš ï¸ ëª¨ë“ˆ ë¡œë”© íƒ€ì„ì•„ì›ƒ');
                        resolve(false);
                        return;
                    }
                    
                    setTimeout(checkModules, 100);
                };
                
                checkModules();
            });
        }

        // ğŸ”§ ì‹œìŠ¤í…œ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSystemStatus(message, color) {
            const statusElement = document.getElementById('system-status');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.style.color = color;
            }
        }

        console.log('ğŸ¯ Index.html v4.2.0 ëª¨ë“ˆí™” ì‹œìŠ¤í…œ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ');
        console.log('ğŸ“¦ ì•„í‚¤í…ì²˜: ê¸°ì¡´ ë‹¨ìˆœ êµ¬ì¡° â†’ v4.2.0 ëª¨ë“ˆí™” êµ¬ì¡°ë¡œ ì—…ê·¸ë ˆì´ë“œ');
        console.log('ğŸ”§ í˜¸í™˜ì„±: AuthManager + SupabaseAPI í†µí•© ë§¤ë‹ˆì € ì‚¬ìš©');
    </script>
</body>
</html>