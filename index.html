<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>세종학당 문화교구 신청 플랫폼</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/login.css">
    <link rel="stylesheet" href="css/student.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/lesson-plan.css">
    
    <!-- Polyfills for browser compatibility (로드 순서 중요) -->
    <script>
        // Promise polyfill for older browsers
        if (typeof Promise === 'undefined') {
            document.write('<script src="https://cdn.jsdelivr.net/npm/es6-promise@4.2.8/dist/es6-promise.auto.min.js"><\/script>');
        }
        
        // fetch polyfill for older browsers
        if (typeof fetch === 'undefined') {
            document.write('<script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.js"><\/script>');
        }
    </script>
    
    <!-- Lucide Icons - 고정 버전 사용 -->
    <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.js" 
            onerror="console.error('Lucide Icons 로딩 실패'); window.lucide = {createIcons: function(){console.warn('Lucide 아이콘 대체 모드');}};"></script>
    
    <!-- Supabase JavaScript Client - 고정 버전 사용 -->
    <script src="https://unpkg.com/@supabase/supabase-js@2.38.0/dist/umd/supabase.js"
            onerror="console.error('Supabase 라이브러리 로딩 실패'); alert('네트워크 연결을 확인하고 페이지를 새로고침해주세요.');"></script>
    
    <!-- Library loading checker -->
    <script>
        // 필수 라이브러리 로딩 확인
        window.addEventListener('load', function() {
            const missingLibraries = [];
            
            if (typeof supabase === 'undefined') {
                missingLibraries.push('Supabase');
            }
            
            if (typeof lucide === 'undefined') {
                missingLibraries.push('Lucide Icons');
                // Lucide 대체 함수 제공
                window.lucide = {
                    createIcons: function() {
                        console.warn('Lucide 아이콘을 사용할 수 없습니다.');
                    }
                };
            }
            
            if (missingLibraries.length > 0) {
                console.error('라이브러리 로딩 실패:', missingLibraries);
                const userMessage = `일부 기능을 위한 라이브러리 로딩에 실패했습니다 (${missingLibraries.join(', ')}). 인터넷 연결을 확인하고 페이지를 새로고침해주세요.`;
                alert(userMessage);
            }
        });
    </script>
</head>
<body>
    <!-- Main App Container -->
    <div id="app">
        <!-- 로그인 페이지 -->
        <div id="loginPage" class="page active">
            <div class="login-container">
                <div class="login-card">
                    <div class="login-header">
                        <h1>세종학당 문화교구 신청</h1>
                        <p>Cultural Equipment Request Platform</p>
                    </div>

                    <div class="login-tabs">
                        <button id="studentTab" class="tab-btn active">학생 로그인</button>
                        <button id="adminTab" class="tab-btn">관리자 로그인</button>
                    </div>

                    <!-- 학생 로그인 폼 -->
                