<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏÑ∏Ï¢ÖÌïôÎãπ Î¨∏ÌôîÏù∏ÌÑ¥ ÏßÄÏõê ÏãúÏä§ÌÖú - Í¥ÄÎ¶¨Ïûê v5.2.1</title>
    
    <!-- CSS Files - v5.2.1 ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ Ï∂îÍ∞Ä -->
    <link rel="stylesheet" href="css/main.css?v=5.2.1">
    <link rel="stylesheet" href="css/login.css?v=5.2.1">
    
    <!-- Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú Ï†ÑÏö© Ïä§ÌÉÄÏùº -->
    <style>
        .dashboard-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            padding: 2rem;
        }

        .dashboard-header {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .welcome-section {
            text-align: center;
            margin-bottom: 2rem;
        }

        .welcome-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 1rem;
        }

        .admin-info {
            background: #2d3748;
            color: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .admin-info h3 {
            margin: 0 0 0.5rem 0;
            color: white;
        }

        .admin-info p {
            margin: 0;
            color: #cbd5e0;
        }

        /* üÜï v5.2.1 Î™®Îìà Î°úÎî© ÏÉÅÌÉú ÌëúÏãú */
        .module-status {
            background: #1a202c;
            color: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            font-family: monospace;
            font-size: 0.875rem;
        }

        .module-status h4 {
            margin: 0 0 0.5rem 0;
            color: white;
            font-size: 1rem;
            font-family: inherit;
        }

        .module-status .module-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
            border-bottom: 1px solid #4a5568;
        }

        .module-status .module-item:last-child {
            border-bottom: none;
        }

        .module-status .status-icon {
            font-weight: bold;
        }

        .status-loading { color: #f6ad55; }
        .status-success { color: #68d391; }
        .status-error { color: #fc8181; }

        /* üîá Î°úÍ∑∏ Ï†úÏñ¥ ÏÑπÏÖò */
        .log-control-section {
            background: #1a202c;
            color: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-control-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .log-mode-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .log-mode-badge.production {
            background: #22543d;
            color: #c6f6d5;
        }

        .log-mode-badge.development {
            background: #d69e2e;
            color: #faf089;
        }

        .log-toggle-btn {
            background: #4a5568;
            color: white;
            border: none;
            border-radius: 0.25rem;
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background 0.3s ease;
        }

        .log-toggle-btn:hover {
            background: #2d3748;
        }

        /* Í∏∞Îä• ÌôúÏÑ±Ìôî Í¥ÄÎ¶¨ ÏÑπÏÖò */
        .feature-settings-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .feature-settings-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feature-list {
            display: grid;
            gap: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .feature-item {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .feature-item.active {
            border-color: #48bb78;
            background: #f0fff4;
        }

        .feature-item.inactive {
            border-color: #fc8181;
            background: #fff5f5;
        }

        .feature-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .feature-icon {
            width: 3rem;
            height: 3rem;
            background: linear-gradient(135deg, #2d3748, #4a5568);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .feature-icon.active {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        .feature-icon.inactive {
            background: linear-gradient(135deg, #fc8181, #f56565);
        }

        .feature-icon i {
            width: 1.5rem;
            height: 1.5rem;
        }

        .feature-details h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
            margin: 0 0 0.25rem 0;
        }

        .feature-details p {
            font-size: 0.875rem;
            color: #718096;
            margin: 0;
        }

        .feature-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .feature-status {
            font-size: 0.875rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            min-width: 4rem;
            text-align: center;
        }

        .feature-status.active {
            background: #c6f6d5;
            color: #22543d;
        }

        .feature-status.inactive {
            background: #fed7d7;
            color: #c53030;
        }

        /* ÌÜ†Í∏Ä Ïä§ÏúÑÏπò */
        .toggle-switch {
            position: relative;
            width: 3.5rem;
            height: 2rem;
            background: #cbd5e0;
            border-radius: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .toggle-switch.active {
            background: #48bb78;
        }

        .toggle-switch::before {
            content: '';
            position: absolute;
            top: 0.125rem;
            left: 0.125rem;
            width: 1.75rem;
            height: 1.75rem;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.active::before {
            transform: translateX(1.5rem);
        }

        /* Í¥ÄÎ¶¨ Î©îÎâ¥ Í∑∏Î¶¨Îìú */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .menu-card {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #2d3748, #4a5568);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .menu-card:hover::before {
            transform: scaleX(1);
        }

        .menu-icon {
            width: 4rem;
            height: 4rem;
            margin: 0 auto 1.5rem;
            background: linear-gradient(135deg, #2d3748, #4a5568);
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .menu-icon i {
            width: 2rem;
            height: 2rem;
        }

        .menu-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 1rem;
            text-align: center;
        }

        .menu-description {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 2rem;
            text-align: center;
        }

        .menu-button {
            width: 100%;
            background: linear-gradient(135deg, #2d3748, #4a5568);
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .menu-button:hover {
            background: linear-gradient(135deg, #1a202c, #2d3748);
            transform: translateY(-2px);
        }

        .logout-section {
            text-align: center;
            margin-top: 2rem;
        }

        .logout-btn {
            background: #fed7d7;
            color: #c53030;
            border: 2px solid #fc8181;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #fc8181;
            color: white;
        }

        /* Î°úÎî© ÏÉÅÌÉú */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .loading .toggle-switch {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú ÌëúÏãú */
        .init-status {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: #1a202c;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            z-index: 1000;
            max-width: 300px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .init-status.success {
            background: #22543d;
        }

        .init-status.error {
            background: #c53030;
        }

        .init-status.warning {
            background: #d69e2e;
        }

        /* ÏãúÏä§ÌÖú ÏÉÅÌÉú ÏïåÎ¶º */
        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 16px 0;
        }

        .alert-success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }

        .alert-info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }

        /* ÏÉàÎ°úÏö¥ Í∏∞Îä• ÌïòÏù¥ÎùºÏù¥Ìä∏ */
        .new-feature-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #f093fb;
            background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            box-shadow: 0 2px 8px rgba(240, 147, 251, 0.3);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        /* Î™®Î∞îÏùº Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 1rem;
            }

            .dashboard-header {
                padding: 1.5rem;
            }

            .welcome-title {
                font-size: 2rem;
            }

            .menu-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .menu-card {
                padding: 1.5rem;
            }

            .feature-list {
                gap: 0.75rem;
            }

            .feature-item {
                padding: 1rem;
                flex-direction: column;
                text-align: center;
            }

            .feature-controls {
                margin-top: 1rem;
            }

            .module-status {
                font-size: 0.75rem;
            }

            .log-control-section {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄ -->
        <div id="loginPage" class="page active">
            <div class="login-container">
                <div class="login-card">
                    <div class="login-header">
                        <h1>ÏÑ∏Ï¢ÖÌïôÎãπ Î¨∏ÌôîÏù∏ÌÑ¥ ÏßÄÏõê ÏãúÏä§ÌÖú v5.2.1</h1>
                        <p>Cultural Intern Support System - Administrator (ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ Ï∂îÍ∞Ä)</p>
                    </div>

                    <div id="adminLogin" class="login-form active">
                        <div class="form-group">
                            <label>Í¥ÄÎ¶¨Ïûê ÏΩîÎìú</label>
                            <input type="password" id="adminCode" placeholder="Í¥ÄÎ¶¨Ïûê ÏΩîÎìúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                        </div>
                        <button id="adminLoginBtn" class="login-btn admin">
                            <i data-lucide="log-in"></i>
                            Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú -->
        <div id="adminPage" class="page">
            <div class="dashboard-container">
                <!-- Ìó§Îçî ÏÑπÏÖò -->
                <div class="dashboard-header">
                    <div class="welcome-section">
                        <h1 class="welcome-title">Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú v5.2.1</h1>
                        <p class="welcome-subtitle">Cultural Intern Support System - Administrator (ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ Ï∂îÍ∞Ä)</p>
                    </div>
                    
                    <div class="admin-info">
                        <h3>Í¥ÄÎ¶¨ÏûêÎãò, ÌôòÏòÅÌï©ÎãàÎã§!</h3>
                        <p>ÏÑ∏Ï¢ÖÌïôÎãπ Î¨∏ÌôîÏù∏ÌÑ¥ ÏßÄÏõê ÏãúÏä§ÌÖúÏùÑ Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                    </div>

                    <!-- üîá Î°úÍ∑∏ Ï†úÏñ¥ ÏÑπÏÖò -->
                    <div class="log-control-section">
                        <div class="log-control-info">
                            <span>üîá Î°úÍ∑∏ Ï∂úÎ†• Î™®Îìú:</span>
                            <span class="log-mode-badge production" id="logModeBadge">ÌîÑÎ°úÎçïÏÖò (ÏµúÏÜå)</span>
                        </div>
                        <button class="log-toggle-btn" onclick="LogController.toggleMode()">
                            <span id="logToggleText">Í∞úÎ∞ú Î™®Îìú ÌôúÏÑ±Ìôî</span>
                        </button>
                    </div>

                    <!-- üÜï v5.2.1 Î™®Îìà Î°úÎî© ÏÉÅÌÉú ÌëúÏãú -->
                    <div class="module-status" id="moduleStatus">
                        <h4>üì¶ Î™®Îìà Î°úÎî© ÏÉÅÌÉú (v5.2.1 ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ Ìè¨Ìï®)</h4>
                        <div class="module-item">
                            <span>SupabaseCore (5.6KB)</span>
                            <span class="status-icon status-loading" id="status-core">‚è≥</span>
                        </div>
                        <div class="module-item">
                            <span>SupabaseStudent (32.9KB)</span>
                            <span class="status-icon status-loading" id="status-student">‚è≥</span>
                        </div>
                        <div class="module-item">
                            <span>SupabaseAdmin (41.5KB)</span>
                            <span class="status-icon status-loading" id="status-admin">‚è≥</span>
                        </div>
                        <div class="module-item">
                            <span>ÌÜµÌï© Îß§ÎãàÏ†Ä (19.2KB)</span>
                            <span class="status-icon status-loading" id="status-unified">‚è≥</span>
                        </div>
                        <div class="module-item">
                            <span>Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú</span>
                            <span class="status-icon status-loading" id="status-admin-system">‚è≥</span>
                        </div>
                    </div>
                </div>

                <!-- ÏãúÏä§ÌÖú ÏÉÅÌÉú ÏïåÎ¶º -->
                <div id="systemStatus"></div>

                <!-- Í∏∞Îä• ÌôúÏÑ±Ìôî Í¥ÄÎ¶¨ ÏÑπÏÖò -->
                <div class="feature-settings-section">
                    <h2 class="feature-settings-title">
                        <i data-lucide="settings"></i>
                        Í∏∞Îä• ÌôúÏÑ±Ìôî Í¥ÄÎ¶¨
                        <span class="new-feature-badge">NEW</span>
                    </h2>
                    <div class="feature-list" id="featureList">
                        <!-- üîÑ AdminFeatureSettings Î™®ÎìàÏóêÏÑú ÏûêÎèô Î°úÎî© -->
                        <div class="feature-item">
                            <div class="feature-info">
                                <div class="feature-icon">
                                    <i data-lucide="settings"></i>
                                </div>
                                <div class="feature-details">
                                    <h4>Í∏∞Îä• ÏÑ§Ï†ï Î°úÎî© Ï§ë...</h4>
                                    <p>v5.2.1 AdminFeatureSettings Î™®Îìà Ï¥àÍ∏∞Ìôî Ï§ëÏûÖÎãàÎã§.</p>
                                </div>
                            </div>
                            <div class="feature-controls">
                                <span class="feature-status">Î°úÎî© Ï§ë</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Í¥ÄÎ¶¨ Î©îÎâ¥ Í∑∏Î¶¨Îìú -->
                <div class="menu-grid">
                    <!-- ÌååÍ≤¨ ÌïôÎãπ Ï†ïÎ≥¥ Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToInstituteManagement()">
                        <div class="menu-icon">
                            <i data-lucide="building"></i>
                        </div>
                        <h2 class="menu-title">ÌååÍ≤¨ ÌïôÎãπ Ï†ïÎ≥¥ Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            ÏÑ∏Ï¢ÖÌïôÎãπ Ï†ïÎ≥¥Î•º Îì±Î°ùÌïòÍ≥† Í¥ÄÎ¶¨Ìï©ÎãàÎã§.<br>
                            ÌïôÏÉù Î∞∞Ï†ï Î∞è ÌòÑÏßÄ Ï†ïÎ≥¥Î•º ÏóÖÎç∞Ïù¥Ìä∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>

                    <!-- Ìï≠Í≥µÍ∂å Íµ¨Îß§ Ïã†Ï≤≠ Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToFlightManagement()">
                        <div class="menu-icon">
                            <i data-lucide="plane"></i>
                        </div>
                        <h2 class="menu-title">Ìï≠Í≥µÍ∂å Íµ¨Îß§ Ïã†Ï≤≠ Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            ÌïôÏÉùÎì§Ïùò Ìï≠Í≥µÍ∂å Íµ¨Îß§ Ïã†Ï≤≠ÏùÑ Í≤ÄÌÜ†ÌïòÍ≥†<br>
                            ÏäπÏù∏ Ï≤òÎ¶¨Î•º ÏßÑÌñâÌï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>

                    <!-- ÍµêÍµ¨ Íµ¨Îß§ Ïã†Ï≤≠ Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToEquipmentManagement()">
                        <div class="menu-icon">
                            <i data-lucide="package"></i>
                        </div>
                        <h2 class="menu-title">ÍµêÍµ¨ Íµ¨Îß§ Ïã†Ï≤≠ Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            ÌïôÏÉùÎì§Ïùò ÍµêÍµ¨ Ïã†Ï≤≠ÏùÑ Í≤ÄÌÜ†ÌïòÍ≥†<br>
                            ÏòàÏÇ∞ ÏäπÏù∏ Î∞è Íµ¨Îß§ Ï≤òÎ¶¨Î•º Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>

                    <!-- üÜï ÌäπÎ≥Ñ ÏòàÏÇ∞ ÏßÄÏõê Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToBudgetManagement()">
                        <div class="menu-icon">
                            <i data-lucide="wallet"></i>
                        </div>
                        <h2 class="menu-title">ÌäπÎ≥Ñ ÏòàÏÇ∞ ÏßÄÏõê Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            ÌïôÏÉùÎì§Ïùò ÌäπÎ≥Ñ ÏòàÏÇ∞ ÏßÄÏõê Ïã†Ï≤≠ÏùÑ Í≤ÄÌÜ†ÌïòÍ≥†<br>
                            ÏäπÏù∏ Î∞è Î∞òÎ†§ Ï≤òÎ¶¨Î•º Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>
                    
                    <!-- üÜï ÎπÑÏûê Î∞úÍ∏â Í¥ÄÎ¶¨ (Íµ≠Í∞ÄÎ≥Ñ ÏïàÏ†ÑÏ†ïÎ≥¥ Í¥ÄÎ¶¨ Îã§ÏùåÏóê Ï∂îÍ∞Ä) -->
                    <div class="menu-card" onclick="navigateToVisaManagement()">
                        <div class="menu-icon">
                            <i data-lucide="file-badge"></i>
                        </div>
                        <h2 class="menu-title">ÎπÑÏûê Î∞úÍ∏â Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            ÌïôÏÉùÎì§Ïùò ÎπÑÏûê Î∞úÍ∏â ÌòÑÌô©ÏùÑ Î™®ÎãàÌÑ∞ÎßÅÌïòÍ≥†<br>
                            Í¥ÄÎ¶¨Ïûê ÏΩîÎ©òÌä∏ÏôÄ ÏÑúÎ•òÎ•º Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>
                    
                    <!-- üí∞ Ïã§ÎπÑ ÏßÄÏõê Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToReimbursementManagement()">
                        <div class="menu-icon">
                            <i data-lucide="receipt"></i>
                        </div>
                        <h2 class="menu-title">Ïã§ÎπÑ ÏßÄÏõê Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            Î¨∏ÌôîÏù∏ÌÑ¥ ÌïôÏÉù Ïã§ÎπÑ ÏßÄÏõê Í¥ÄÎ¶¨.<br>
                            Ï∞®ÏàòÎ≥Ñ Í∏àÏï° ÏÑ§Ï†ï Î∞è ÏßÄÍ∏â Ï≤òÎ¶¨.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>

                    <!-- üÜï ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToExamManagement()">
                        <div class="menu-icon">
                            <i data-lucide="clipboard-check"></i>
                        </div>
                        <h2 class="menu-title">ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            Î¨∏Ï†ú Ï∂úÏ†ú, ÏãúÌóò Í≤∞Í≥º Ï°∞Ìöå Î∞è<br>
                            ÌèâÍ∞Ä ÏÑ§Ï†ïÏùÑ Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>

                    <!-- üÜï Íµ≠Í∞ÄÎ≥Ñ ÏïàÏ†ÑÏ†ïÎ≥¥ Í¥ÄÎ¶¨ -->
                    <div class="menu-card" onclick="navigateToCountrySafetyManagement()">
                        <div class="menu-icon">
                            <i data-lucide="globe"></i>
                        </div>
                        <h2 class="menu-title">Íµ≠Í∞ÄÎ≥Ñ ÏïàÏ†ÑÏ†ïÎ≥¥ Í¥ÄÎ¶¨</h2>
                        <p class="menu-description">
                            ÌååÍ≤¨Íµ≠Í∞ÄÎ≥Ñ ÏïàÏ†Ñ Ï†ïÎ≥¥ Î∞è ÎåÄÏÇ¨Í¥Ä Ïó∞ÎùΩÏ≤òÎ•º<br>
                            Îì±Î°ùÌïòÍ≥† Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                        </p>
                        <button class="menu-button">
                            <i data-lucide="arrow-right"></i>
                            Í¥ÄÎ¶¨ÌïòÍ∏∞
                        </button>
                    </div>
                </div>

                <!-- Î°úÍ∑∏ÏïÑÏõÉ ÏÑπÏÖò -->
                <div class="logout-section">
                    <button class="logout-btn" onclick="handleLogout()">
                        <i data-lucide="log-out"></i>
                        Î°úÍ∑∏ÏïÑÏõÉ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú ÌëúÏãú -->
    <div id="initStatus" class="init-status" style="display: none;">
        ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ï§ë...
    </div>

    <!-- üöÄ JavaScript Files - v5.2.1 ÏãúÏä§ÌÖú -->
    
    <!-- üîß 1Îã®Í≥Ñ: ÌïµÏã¨ ÎùºÏù¥Î∏åÎü¨Î¶¨ -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <!-- üîß 2Îã®Í≥Ñ: ÌïµÏã¨ ÏÑ§Ï†ï (ÌïÑÏàò) -->
    <script src="js/config.js?v=5.2.1"></script>
    <script src="js/utils.js?v=5.2.1"></script>
    <script src="js/auth.js?v=5.2.1"></script>

    <!-- üîß 3Îã®Í≥Ñ: Supabase Î™®ÎìàÎì§ (ÏàúÏÑú Ï§ëÏöî!) -->
    <script src="js/supabase/supabase-core.js?v=5.2.1"></script>
    <script src="js/supabase/supabase-student.js?v=5.2.1"></script>
    <script src="js/supabase/supabase-admin.js?v=5.2.1"></script>
    <script src="js/supabase-client.js?v=5.2.1"></script>
    
    <!-- üîß 4Îã®Í≥Ñ: Í¥ÄÎ¶¨Ïûê Î™®ÎìàÎì§ (ÌïÑÏöîÌïú Í≤ΩÏö∞Îßå) -->
    <script src="js/admin/admin-core.js?v=5.2.1"></script>
    <script src="js/admin/admin-utils.js?v=5.2.1"></script>
    <script src="js/admin/admin-modals.js?v=5.2.1"></script>
    <script src="js/admin/admin-budget.js?v=5.2.1"></script>
    <script src="js/admin/admin-lesson-plans.js?v=5.2.1"></script>
    <script src="js/admin/admin-applications.js?v=5.2.1"></script>
    <!-- üÜï AdminFeatureSettings Î™®Îìà (ÏûêÎèô Ï¥àÍ∏∞Ìôî) -->
    <script src="js/admin/admin-features.js?v=5.2.1"></script>
    
    <!-- üîß 5Îã®Í≥Ñ: Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄ ÌïµÏã¨ ÏãúÏä§ÌÖú - v5.2.1 -->
    <script>
        // üîá Î°úÍ∑∏ Ï†úÏñ¥ ÏãúÏä§ÌÖú (v5.2.1)
        const LogController = {
            isProductionMode: true, // Í∏∞Î≥∏Í∞í: ÌîÑÎ°úÎçïÏÖò Î™®Îìú (Î°úÍ∑∏ ÏµúÏÜåÌôî)
            
            // Î°úÍ∑∏ Ï∂úÎ†• Ìï®Ïàò (Î™®ÎìúÏóê Îî∞Îùº Ï†úÏñ¥)
            log(...args) {
                if (!this.isProductionMode) {
                    console.log(...args);
                }
            },
            
            info(...args) {
                if (!this.isProductionMode) {
                    console.info(...args);
                }
            },
            
            warn(...args) {
                // Í≤ΩÍ≥†Îäî Ìï≠ÏÉÅ Ï∂úÎ†•
                console.warn(...args);
            },
            
            error(...args) {
                // ÏóêÎü¨Îäî Ìï≠ÏÉÅ Ï∂úÎ†•
                console.error(...args);
            },
            
            // Ï§ëÏöîÌïú ÏãúÏä§ÌÖú Î©îÏãúÏßÄ (Ìï≠ÏÉÅ Ï∂úÎ†•)
            system(...args) {
                console.log(...args);
            },
            
            // Î™®Îìú ÌÜ†Í∏Ä
            toggleMode() {
                this.isProductionMode = !this.isProductionMode;
                this.updateUI();
                
                if (this.isProductionMode) {
                    this.system('üîá ÌîÑÎ°úÎçïÏÖò Î™®Îìú ÌôúÏÑ±Ìôî - Î°úÍ∑∏ Ï∂úÎ†• ÏµúÏÜåÌôî');
                } else {
                    this.system('üîß Í∞úÎ∞ú Î™®Îìú ÌôúÏÑ±Ìôî - ÏÉÅÏÑ∏ Î°úÍ∑∏ Ï∂úÎ†•');
                }
                
                // ÏÑ§Ï†ï Ï†ÄÏû•
                localStorage.setItem('adminLogMode', this.isProductionMode ? 'production' : 'development');
            },
            
            // UI ÏóÖÎç∞Ïù¥Ìä∏
            updateUI() {
                const badge = document.getElementById('logModeBadge');
                const toggleText = document.getElementById('logToggleText');
                
                if (badge && toggleText) {
                    if (this.isProductionMode) {
                        badge.textContent = 'ÌîÑÎ°úÎçïÏÖò (ÏµúÏÜå)';
                        badge.className = 'log-mode-badge production';
                        toggleText.textContent = 'Í∞úÎ∞ú Î™®Îìú ÌôúÏÑ±Ìôî';
                    } else {
                        badge.textContent = 'Í∞úÎ∞ú (ÏÉÅÏÑ∏)';
                        badge.className = 'log-mode-badge development';
                        toggleText.textContent = 'ÌîÑÎ°úÎçïÏÖò Î™®Îìú ÌôúÏÑ±Ìôî';
                    }
                }
            },
            
            // Ï¥àÍ∏∞Ìôî
            init() {
                // Ï†ÄÏû•Îêú ÏÑ§Ï†ï Î°úÎìú
                const savedMode = localStorage.getItem('adminLogMode');
                if (savedMode) {
                    this.isProductionMode = savedMode === 'production';
                }
                
                this.updateUI();
                this.system('üîá Î°úÍ∑∏ Ï†úÏñ¥ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å -', this.isProductionMode ? 'ÌîÑÎ°úÎçïÏÖò Î™®Îìú' : 'Í∞úÎ∞ú Î™®Îìú');
            }
        };

        // Ï†ÑÏó≠ÏúºÎ°ú LogController ÎÖ∏Ï∂ú
        window.LogController = LogController;

        // üîß Î™®Îìà ÏÉÅÌÉú Ï∂îÏ†Å Í∞ùÏ≤¥ (Í¥ÄÎ¶¨ÏûêÏö©) - Î°úÍ∑∏ Ï†úÏñ¥ Ï†ÅÏö©
        const AdminModuleStatusTracker = {
            modules: {
                core: { name: 'SupabaseCore', loaded: false, size: '5.6KB' },
                student: { name: 'SupabaseStudent', loaded: false, size: '32.9KB' },
                admin: { name: 'SupabaseAdmin', loaded: false, size: '41.5KB' },
                unified: { name: 'ÌÜµÌï© Îß§ÎãàÏ†Ä', loaded: false, size: '19.2KB' },
                adminSystem: { name: 'Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú', loaded: false, size: 'modular' }
            },

            // ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            updateStatus(moduleKey, isLoaded) {
                const module = this.modules[moduleKey];
                if (module) {
                    module.loaded = isLoaded;
                    const statusElement = document.getElementById(`status-${moduleKey.replace(/([A-Z])/g, '-$1').toLowerCase()}`);
                    if (statusElement) {
                        statusElement.textContent = isLoaded ? '‚úÖ' : '‚ùå';
                        statusElement.className = `status-icon ${isLoaded ? 'status-success' : 'status-error'}`;
                    }
                }
                this.checkAllModules();
            },

            // Ï†ÑÏ≤¥ Î™®Îìà ÏÉÅÌÉú ÌôïÏù∏
            checkAllModules() {
                const allLoaded = Object.values(this.modules).every(module => module.loaded);
                
                if (allLoaded) {
                    this.showSystemReport();
                }
            },

            // ÏãúÏä§ÌÖú Î¶¨Ìè¨Ìä∏ ÌëúÏãú
            showSystemReport() {
                const systemStatus = document.getElementById('systemStatus');
                if (systemStatus) {
                    systemStatus.innerHTML = `
                        <div class="alert alert-success">
                            <strong>üîê Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú v5.2.1 Ï¥àÍ∏∞Ìôî ÏôÑÎ£å!</strong><br>
                            ‚Ä¢ üÜï ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú Ï∂îÍ∞Ä<br>
                            ‚Ä¢ ÌÜµÌï© Í¥ÄÎ¶¨: Core + Student + Admin Î™®Îìà ÏôÑÏ†Ñ Î°úÎìú<br>
                            ‚Ä¢ Í¥ÄÎ¶¨Ïûê Í∂åÌïú: Î™®Îì† Í∏∞Îä• Ï†ëÍ∑º Í∞ÄÎä•<br>
                            ‚Ä¢ üîá Î°úÍ∑∏ Ï†úÏñ¥: ÌîÑÎ°úÎçïÏÖò/Í∞úÎ∞ú Î™®Îìú ÏßÄÏõê<br>
                            ‚Ä¢ ‚úÖ AdminFeatureSettings Î™®Îìà Ïó∞Îèô ÏôÑÎ£å<br>
                            ‚Ä¢ Ìò∏ÌôòÏÑ±: Í∏∞Ï°¥ Í¥ÄÎ¶¨Ïûê ÏΩîÎìú 100% Ìò∏Ìôò Î≥¥Ïû•
                        </div>
                    `;
                }
            }
        };

        // üîß Î™®Îìà Î°úÎî© Í∞êÏßÄ Ìï®Ïàò (Í¥ÄÎ¶¨ÏûêÏö©) - Î°úÍ∑∏ Ï†úÏñ¥ Ï†ÅÏö©
        function checkAdminModuleLoading() {
            // SupabaseCore ÌôïÏù∏
            if (window.SupabaseCore) {
                AdminModuleStatusTracker.updateStatus('core', true);
                LogController.log('‚úÖ SupabaseCore Î™®Îìà Î°úÎìú ÏôÑÎ£å');
            }

            // SupabaseStudent ÌôïÏù∏
            if (window.SupabaseStudent) {
                AdminModuleStatusTracker.updateStatus('student', true);
                LogController.log('‚úÖ SupabaseStudent Î™®Îìà Î°úÎìú ÏôÑÎ£å');
            }

            // SupabaseAdmin ÌôïÏù∏
            if (window.SupabaseAdmin) {
                AdminModuleStatusTracker.updateStatus('admin', true);
                LogController.log('‚úÖ SupabaseAdmin Î™®Îìà Î°úÎìú ÏôÑÎ£å');
            }

            // ÌÜµÌï© Îß§ÎãàÏ†Ä ÌôïÏù∏
            if (window.SupabaseAPI && window.SupabaseAPI.getHealthReport) {
                AdminModuleStatusTracker.updateStatus('unified', true);
                
                // ÌÜµÌï© Îß§ÎãàÏ†Ä ÏÉÅÌÉú Î¶¨Ìè¨Ìä∏ Î°úÍ∑∏ (ÌîÑÎ°úÎçïÏÖò Î™®ÎìúÏóêÏÑúÎäî Ïà®ÍπÄ)
                const healthReport = window.SupabaseAPI.getHealthReport();
                LogController.log('üìä ÌÜµÌï© Îß§ÎãàÏ†Ä ÏÉÅÌÉú Î¶¨Ìè¨Ìä∏ (Í¥ÄÎ¶¨Ïûê v5.2.1):', healthReport);
            }

            // Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú ÌôïÏù∏ (AdminFeatureSettings Ìè¨Ìï®)
            if (window.AdminManager || window.AdminFeatureSettings) {
                AdminModuleStatusTracker.updateStatus('adminSystem', true);
                LogController.log('‚úÖ AdminManager ÏãúÏä§ÌÖú Î°úÎìú ÏôÑÎ£å');
            }
        }

        // Ï†ÑÏó≠ ÎÑ§ÏûÑÏä§ÌéòÏù¥Ïä§Î°ú Ï∂©Îèå Î∞©ÏßÄ
        window.AdminPageController = (function() {
            'use strict';
            
            // Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú Í¥ÄÎ¶¨ (Í≥†Ïú† Î≥ÄÏàòÎ™Ö ÏÇ¨Ïö©)
            const adminInitState = {
                configLoaded: false,
                supabaseInitialized: false,
                adminManagerReady: false,
                retryCount: 0,
                maxRetries: 3
            };

            // Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú ÌëúÏãú Í¥ÄÎ¶¨
            const InitManager = {
                status: document.getElementById('initStatus'),
                
                show(message, type = 'info') {
                    if (this.status) {
                        this.status.textContent = message;
                        this.status.className = `init-status ${type}`;
                        this.status.style.display = 'block';
                    }
                    LogController.log(`üîÑ ${message}`);
                },
                
                hide() {
                    if (this.status) {
                        setTimeout(() => {
                            this.status.style.display = 'none';
                        }, 2000);
                    }
                },
                
                success(message) {
                    this.show(message, 'success');
                    this.hide();
                },
                
                error(message) {
                    this.show(message, 'error');
                    setTimeout(() => this.hide(), 5000); // ÏóêÎü¨Îäî Îçî Ïò§Îûò ÌëúÏãú
                },

                warning(message) {
                    this.show(message, 'warning');
                    setTimeout(() => this.hide(), 3000);
                }
            };

            // ÏïàÏ†ÑÌïú Ï¥àÍ∏∞Ìôî Ìï®Ïàò (v5.2.1) - Î°úÍ∑∏ Ï†úÏñ¥ Ï†ÅÏö©
            async function safeInitialize() {
                try {
                    // üîá Î°úÍ∑∏ Ï†úÏñ¥ ÏãúÏä§ÌÖú Î®ºÏ†Ä Ï¥àÍ∏∞Ìôî
                    LogController.init();
                    
                    InitManager.show('Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú v5.2.1 Ï¥àÍ∏∞Ìôî Ï§ë...');
                    
                    // 1. ÌïÑÏàò Í∞ùÏ≤¥Îì§Ïù¥ Î°úÎìúÎê† ÎïåÍπåÏßÄ ÎåÄÍ∏∞
                    await waitForEssentials();
                    InitManager.show('ÌïÑÏàò ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎìú ÏôÑÎ£å');
                    
                    // 2. Lucide ÏïÑÏù¥ÏΩò Ï¥àÍ∏∞Ìôî
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                        InitManager.show('ÏïÑÏù¥ÏΩò Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                    }
                    
                    // üÜï v5.2.1 Î™®Îìà Î°úÎî© Í∞êÏßÄ ÏãúÏûë
                    checkAdminModuleLoading();

                    // Ï£ºÍ∏∞Ï†ÅÏúºÎ°ú Î™®Îìà ÏÉÅÌÉú ÌôïÏù∏ (ÏµúÎåÄ 15Ï¥à)
                    let checkCount = 0;
                    const maxChecks = 150; // 15Ï¥à
                    const checkInterval = setInterval(() => {
                        checkAdminModuleLoading();
                        checkCount++;

                        if (checkCount >= maxChecks) {
                            clearInterval(checkInterval);
                            LogController.warn('‚ö†Ô∏è Î™®Îìà Î°úÎî© ÌÉÄÏûÑÏïÑÏõÉ (15Ï¥à) - ÏùºÎ∂Ä Î™®ÎìàÏù¥ Î°úÎìúÎêòÏßÄ ÏïäÏïòÏùÑ Ïàò ÏûàÏùå');
                        }
                    }, 100);
                    
                    // 3. SupabaseAPI Ï¥àÍ∏∞Ìôî ÎåÄÍ∏∞ (Ï§ëÏöî!)
                    await waitForSupabaseAPI();
                    InitManager.show('Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïó∞Í≤∞ ÏôÑÎ£å');
                    
                    // 4. AdminManager Ï¥àÍ∏∞Ìôî ÌôïÏù∏
                    await waitForAdminManager();
                    InitManager.show('Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Ï§ÄÎπÑ ÏôÑÎ£å');
                    
                    // 5. Í¥ÄÎ¶¨Ïûê Ïï± Ï¥àÍ∏∞Ìôî
                    await initializeAdminApp();
                    InitManager.success('Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú v5.2.1 Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                    
                    // Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                    adminInitState.supabaseInitialized = true;
                    adminInitState.adminManagerReady = true;
                    
                } catch (error) {
                    LogController.error('‚ùå Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
                    
                    // Ïû¨ÏãúÎèÑ Î°úÏßÅ
                    if (adminInitState.retryCount < adminInitState.maxRetries) {
                        adminInitState.retryCount++;
                        InitManager.warning(`Ï¥àÍ∏∞Ìôî Ïû¨ÏãúÎèÑ Ï§ë... (${adminInitState.retryCount}/${adminInitState.maxRetries})`);
                        
                        setTimeout(() => {
                            safeInitialize();
                        }, 2000 * adminInitState.retryCount); // Ï†êÏßÑÏ†Å ÏßÄÏó∞
                        return;
                    }
                    
                    InitManager.error(`Ï¥àÍ∏∞Ìôî Ïã§Ìå®: ${error.message}`);
                    
                    // ÏÇ¨Ïö©ÏûêÏóêÍ≤å Î¨∏Ï†ú Ìï¥Í≤∞ Î∞©Î≤ï Ï†úÏãú
                    setTimeout(() => {
                        if (confirm('Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Ï¥àÍ∏∞ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\\n\\nÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                            window.location.reload();
                        }
                    }, 1000);
                }
            }

            // ÌïÑÏàò Í∞ùÏ≤¥Îì§Ïù¥ Î°úÎìúÎê† ÎïåÍπåÏßÄ ÎåÄÍ∏∞
            function waitForEssentials() {
                return new Promise((resolve, reject) => {
                    let attempts = 0;
                    const maxAttempts = 50; // 5Ï¥à
                    
                    const check = () => {
                        attempts++;
                        
                        const hasConfig = window.CONFIG;
                        const hasSupabase = window.supabase && typeof window.supabase.createClient === 'function';
                        
                        if (hasConfig && hasSupabase) {
                            LogController.log('‚úÖ Í¥ÄÎ¶¨Ïûê ÌïÑÏàò Í∞ùÏ≤¥ Î°úÎìú ÏôÑÎ£å');
                            adminInitState.configLoaded = true;
                            resolve();
                        } else if (attempts >= maxAttempts) {
                            const missing = [];
                            if (!hasConfig) missing.push('CONFIG');
                            if (!hasSupabase) missing.push('Supabase');
                            reject(new Error(`ÌïÑÏàò ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎìú Ïã§Ìå®: ${missing.join(', ')}`));
                        } else {
                            setTimeout(check, 100);
                        }
                    };
                    
                    check();
                });
            }

            // SupabaseAPI Ï¥àÍ∏∞Ìôî ÎåÄÍ∏∞
            function waitForSupabaseAPI() {
                return new Promise((resolve, reject) => {
                    let attempts = 0;
                    const maxAttempts = 30; // 3Ï¥à
                    
                    const check = async () => {
                        attempts++;
                        
                        if (window.SupabaseAPI && typeof window.SupabaseAPI.init === 'function') {
                            try {
                                LogController.log('üîó Í¥ÄÎ¶¨Ïûê SupabaseAPI Ï¥àÍ∏∞Ìôî Ï§ë...');
                                const success = await window.SupabaseAPI.init();
                                
                                if (success) {
                                    LogController.log('‚úÖ Í¥ÄÎ¶¨Ïûê SupabaseAPI Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                                    resolve();
                                    return;
                                }
                            } catch (error) {
                                LogController.warn(`‚ö†Ô∏è Í¥ÄÎ¶¨Ïûê SupabaseAPI Ï¥àÍ∏∞Ìôî ÏãúÎèÑ ${attempts}/${maxAttempts} Ïã§Ìå®:`, error.message);
                            }
                        }
                        
                        if (attempts >= maxAttempts) {
                            reject(new Error('SupabaseAPI Ï¥àÍ∏∞ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï¥Ï£ºÏÑ∏Ïöî.'));
                        } else {
                            setTimeout(check, 100);
                        }
                    };
                    
                    check();
                });
            }

            // AdminManager Ï¥àÍ∏∞Ìôî ÎåÄÍ∏∞
            function waitForAdminManager() {
                return new Promise((resolve, reject) => {
                    let attempts = 0;
                    const maxAttempts = 30; // 3Ï¥à
                    
                    const check = () => {
                        attempts++;
                        
                        if (window.AdminManager || window.AdminFeatureSettings) {
                            LogController.log('‚úÖ AdminManager/AdminFeatureSettings Ï§ÄÎπÑ ÏôÑÎ£å');
                            resolve();
                        } else if (attempts >= maxAttempts) {
                            LogController.warn('‚ö†Ô∏è AdminManagerÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏßÄÎßå Í≥ÑÏÜç ÏßÑÌñâÌï©ÎãàÎã§.');
                            resolve(); // AdminManagerÍ∞Ä ÏóÜÏñ¥ÎèÑ Í∏∞Î≥∏ Í∏∞Îä•ÏùÄ ÎèôÏûëÌïòÎèÑÎ°ù
                        } else {
                            setTimeout(check, 100);
                        }
                    };
                    
                    check();
                });
            }

            // Í¥ÄÎ¶¨Ïûê Ïï± Ï¥àÍ∏∞Ìôî
            async function initializeAdminApp() {
                LogController.log('üîê Í¥ÄÎ¶¨Ïûê Ïï± Ï¥àÍ∏∞Ìôî ÏãúÏûë (v5.2.1)');
                
                const adminSession = localStorage.getItem('adminSession');
                if (adminSession) {
                    LogController.log('üìã Í∏∞Ï°¥ Í¥ÄÎ¶¨Ïûê ÏÑ∏ÏÖò Î∞úÍ≤¨');
                    await showAdminDashboard();
                } else {
                    LogController.log('üîê Í¥ÄÎ¶¨Ïûê ÏÑ∏ÏÖò ÏóÜÏùå, Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄ ÌëúÏãú');
                }

                setupAdminLoginEvents();
                LogController.log('‚úÖ Í¥ÄÎ¶¨Ïûê Ïï± Ï¥àÍ∏∞Ìôî ÏôÑÎ£å (v5.2.1)');
            }

            // Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï
            function setupAdminLoginEvents() {
                const adminLoginBtn = document.getElementById('adminLoginBtn');
                const adminCodeInput = document.getElementById('adminCode');

                if (adminLoginBtn) {
                    adminLoginBtn.addEventListener('click', handleAdminLogin);
                }

                if (adminCodeInput) {
                    adminCodeInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            handleAdminLogin();
                        }
                    });
                }
            }

            // Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ Ï≤òÎ¶¨ (v5.2.1) - Î°úÍ∑∏ Ï†úÏñ¥ Ï†ÅÏö©
            async function handleAdminLogin() {
                const code = document.getElementById('adminCode').value.trim();
                
                if (!code) {
                    alert('Í¥ÄÎ¶¨Ïûê ÏΩîÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }

                try {
                    // Î°úÎî© ÏÉÅÌÉú ÌëúÏãú
                    const loginBtn = document.getElementById('adminLoginBtn');
                    const originalText = loginBtn.innerHTML;
                    loginBtn.innerHTML = '<i data-lucide="loader-2"></i> Î°úÍ∑∏Ïù∏ Ï§ë...';
                    loginBtn.disabled = true;

                    // üöÄ v5.2.1 Í¥ÄÎ¶¨Ïûê Ïù∏Ï¶ù ÏãúÎèÑ
                    const result = await SupabaseAPI.authenticateAdmin(code);
                    
                    if (result && result.success) {
                        // ÏÑ∏ÏÖò Ï†ÄÏû•
                        localStorage.setItem('adminSession', 'true');
                        localStorage.setItem('adminInfo', JSON.stringify(result.data));
                        
                        // ÎåÄÏãúÎ≥¥ÎìúÎ°ú Ï†ÑÌôò
                        await showAdminDashboard();
                        
                        LogController.system('‚úÖ Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ (v5.2.1):', result.data.name || 'Í¥ÄÎ¶¨Ïûê');
                    } else {
                        alert(result?.message || 'Í¥ÄÎ¶¨Ïûê Ïù∏Ï¶ùÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                    }
                    
                } catch (error) {
                    LogController.error('‚ùå Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ Ïò§Î•ò (v5.2.1):', error);
                    alert('Î°úÍ∑∏Ïù∏ Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                } finally {
                    // Î≤ÑÌäº ÏÉÅÌÉú Î≥µÍµ¨
                    const loginBtn = document.getElementById('adminLoginBtn');
                    loginBtn.innerHTML = '<i data-lucide="log-in"></i> Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏';
                    loginBtn.disabled = false;
                    
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                }
            }

            // Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú ÌëúÏãú
            async function showAdminDashboard() {
                const loginPage = document.getElementById('loginPage');
                const adminPage = document.getElementById('adminPage');
                
                if (loginPage) loginPage.classList.remove('active');
                if (adminPage) adminPage.classList.add('active');
                
                // üÜï AdminFeatureSettings Î™®ÎìàÏù¥ ÏûêÎèôÏúºÎ°ú Ï¥àÍ∏∞ÌôîÎê®
                // (Î≥ÑÎèÑ Ìò∏Ï∂ú Î∂àÌïÑÏöî)
                
                // ÏïÑÏù¥ÏΩò Ïû¨Ï¥àÍ∏∞Ìôî
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }

                LogController.log('‚úÖ Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú ÌëúÏãú ÏôÑÎ£å (v5.2.1) - AdminFeatureSettings ÏûêÎèô Ïó∞Îèô');
            }

            // Î°úÍ∑∏ÏïÑÏõÉ Ï≤òÎ¶¨ (v5.2.1)
            function handleLogout() {
                if (confirm('Î°úÍ∑∏ÏïÑÏõÉÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    localStorage.removeItem('adminSession');
                    localStorage.removeItem('adminInfo');
                    
                    if (window.SupabaseAPI && typeof window.SupabaseAPI.logout === 'function') {
                        window.SupabaseAPI.logout();
                    }
                    
                    LogController.system('‚úÖ Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏ÏïÑÏõÉ ÏôÑÎ£å (v5.2.1)');
                    window.location.reload();
                }
            }

            // üÜï v5.2.1 ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ìï®ÏàòÎì§ (ÌäπÎ≥Ñ ÏòàÏÇ∞ Í¥ÄÎ¶¨ Ï∂îÍ∞Ä)
            function navigateToInstituteManagement() {
                window.location.href = 'admin/institute-management.html';
            }

            function navigateToFlightManagement() {
                window.location.href = 'admin/flight-management.html';
            }

            function navigateToEquipmentManagement() {
                window.location.href = 'admin/equipment-management.html';
            }

            function navigateToBudgetManagement() {
                window.location.href = 'admin/budget-management.html';
            }

            function navigateToExamManagement() {
                window.location.href = 'admin/exam-management.html';
            }

            function navigateToCountrySafetyManagement() {
                window.location.href = 'admin/country-safety-management.html';
            }
            
            function navigateToVisaManagement() {
                window.location.href = 'admin/visa-management.html';
            }
            
            function navigateToReimbursementManagement() {
                window.location.href = 'admin/reimbursement-management.html';
            }

            
            // Ï†ÑÏó≠ Ìï®ÏàòÎ°ú ÎÖ∏Ï∂ú
            window.handleAdminLogin = handleAdminLogin;
            window.handleLogout = handleLogout;
            window.navigateToInstituteManagement = navigateToInstituteManagement;
            window.navigateToFlightManagement = navigateToFlightManagement;
            window.navigateToEquipmentManagement = navigateToEquipmentManagement;
            window.navigateToBudgetManagement = navigateToBudgetManagement;
            window.navigateToExamManagement = navigateToExamManagement;
            window.navigateToCountrySafetyManagement = navigateToCountrySafetyManagement;
            window.navigateToVisaManagement = navigateToVisaManagement;
            window.navigateToReimbursementManagement = navigateToReimbursementManagement;

            
            // DOMContentLoaded Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
            document.addEventListener('DOMContentLoaded', safeInitialize);

            return {
                initialize: safeInitialize,
                handleAdminLogin,
                handleLogout,
                navigateToInstituteManagement,
                navigateToFlightManagement,
                navigateToEquipmentManagement,
                navigateToBudgetManagement,
                navigateToExamManagement,
                navigateToCountrySafetyManagement,
                navigateToVisaManagement,
                navigateToReimbursementManagement
            };
        })();

        LogController.system('üîê Í¥ÄÎ¶¨Ïûê v5.2.1 ÏãúÏä§ÌÖú Ïä§ÌÅ¨Î¶ΩÌä∏ Î°úÎìú ÏôÑÎ£å');
        LogController.system('üì¶ ÏïÑÌÇ§ÌÖçÏ≤ò: Core + Student + Admin + ÌÜµÌï©Îß§ÎãàÏ†Ä + AdminFeatureSettings');
        LogController.system('üÜï v5.2.1: ÏàòÎ£åÌèâÍ∞Ä Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú Ï∂îÍ∞Ä');
        LogController.system('üîá Î°úÍ∑∏ Ï†úÏñ¥: ÌîÑÎ°úÎçïÏÖò/Í∞úÎ∞ú Î™®Îìú ÏßÄÏõê Ï∂îÍ∞Ä');
        LogController.system('‚úÖ Î™®ÎìàÌôî Íµ¨Ï°∞: admin-features.js Î™®Îìà ÏûêÎèô Ïó∞Îèô ÏôÑÎ£å');
        LogController.system('üîß Í∏∞Ï°¥ Í¥ÄÎ¶¨Ïûê ÏΩîÎìú 100% Ìò∏ÌôòÏÑ± Î≥¥Ïû• + ÏÑ±Îä• ÏµúÏ†ÅÌôî');
    </script>
</body>
</html>
